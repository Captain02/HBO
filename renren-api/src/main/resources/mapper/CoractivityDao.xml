<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="CoractivityDao">
    <!-- 可根据自己的需求，是否要使用 -->

    <select id="coractivitylistPage" resultType="io.renren.common.entity.PageData">
       SELECT
       actid,
      (SELECT filepath FROM filetable WHERE id = videoid)videoid,
      (SELECT filepath FROM filetable WHERE id = images)images,
	(
		SELECT
			fileid
		FROM
			sys_user
		WHERE
			user_id = C.actleading
	) userFileid,
	actname,
	PROFILE,
	(
		SELECT
			COUNT(topicid)
		FROM
			bbs_like
		WHERE
			topicid = C.actid
	) topicCount,
	(
		SELECT
			corname
		FROM
			corporation
		WHERE
			id = C.actcorid
	) corname,
	createtime
FROM
	coractivity C
    </select>

	<select id="byPrimaryId" resultType="map" parameterType="java.lang.Long">
	SELECT  actid,actname,actstarttame,actendtime,createtime,actdetails,
	 (SELECT filepath FROM filetable WHERE id = fileid)fileid,
	 (SELECT filepath FROM filetable WHERE id = videoid)videoid,
	 (SELECT filepath FROM filetable WHERE id = images)images,
(
		SELECT
			corname
		FROM
			corporation
		WHERE
			id = C.actleading
	) corname,
	(
		SELECT
			username
		FROM
			sys_user
		WHERE
			user_id = C.actcorid
	) username,
	(SELECT filepath FROM sys_user U LEFT JOIN filetable F ON F.id=U.fileid WHERE user_id = C.actcorid)userfilepath
	FROM
			coractivity C
		WHERE
			C.actid = #{actid}
	</select>
</mapper>